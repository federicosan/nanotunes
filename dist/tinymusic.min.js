var f=/^([A-Z]{3})/,g=/([A-GX]#?)([1-8])([1-9]{1,2})/g,h=new Map([["C",16.35],["C#",17.32],["D",18.35],["D#",19.45],["E",20.6],["F",21.83],["F#",23.12],["G",24.5],["G#",25.96],["A",27.5],["A#",29.14],["B",30.87],["X",0]]);function k(a,b,c){this.a=new AudioContext;this.f=new Map(b);this.b=c/60}k.prototype.play=function(a){a=this.f.get(a);a.match(f);for(var b=[],c;c=g.exec(a);)b.push({length:c[3],c:l(c[1],c[2])});m(this,b)};function l(a,b){return h.get(a)*Math.pow(1.059463094359,12*b)}
function m(a,b){b.reduce(function(b,d){return b.then(function(){return n(a,d)})},Promise.resolve()).then(function(){return m(a,b)})}function n(a,b){return new Promise(function(c){var d=a.a.createOscillator(),e=a.a.createGain();d.type="square";d.frequency.value=b.c;e.gain.value=.3;d.connect(e);e.connect(a.a.destination);d.addEventListener("ended",c);d.start(0);d.stop(a.a.currentTime+b.length/a.b/4)})}module.exports=k;
