(function(){function d(a,b){this.a=new AudioContext;this.s=a;this.u=b}var h=/^([A-Z]{3})/,k=/([A-GX]#?)([1-8])([1-9]{1,2})/g,l=new Map([["C",16.35],["C#",17.32],["D",18.35],["D#",19.45],["E",20.6],["F",21.83],["F#",23.12],["G",24.5],["G#",25.96],["A",27.5],["A#",29.14],["B",30.87],["X",0]]);d.prototype.play=function(a){a=this.u[a];for(var b in a.parts){var c=this.s[this.l(a.parts[b])],e=this.j(a.parts[b],a.bpm);this.c(c,e)}};d.prototype.l=function(a){return a.match(h)[1]};d.prototype.j=function(a,
b){for(var c=[],e;e=k.exec(a);)c.push({length:this.i(e[3],b),o:this.h(e[1],e[2])});return c};d.prototype.i=function(a,b){return parseInt(a)/(b/60)/4};d.prototype.h=function(a,b){return l.get(a)*Math.pow(1.059463094359,12*b)};d.prototype.c=function(a,b){var c=this;b.reduce(function(b,d){return b.then(function(){return c.m(a,d)})},Promise.resolve()).then(function(){return c.c(a,b)})};d.prototype.m=function(a,b){var c=this;return new Promise(function(d){var f=c.a.createOscillator();f.type=a.wave;f.frequency.value=
b.o;var g=c.f(f,a.gain),g=c.g(g,a.pan);g.connect(c.a.destination);f.addEventListener("ended",d);f.start(0);f.stop(c.a.currentTime+b.length)})};d.prototype.f=function(a,b){return this.b(a,b,"createGain","gain")};d.prototype.g=function(a,b){return this.b(a,b,"createStereoPanner","pan")};d.prototype.b=function(a,b,c,d){if(!b)return a;c=this.a[c]();c[d].value=b;a.connect(c);return c};this.TM=d})(this);
